---
import { getCollection } from 'astro:content';

import DefaultLayout from '@layouts/default.layout.astro';
import { isInlineSection } from '@utils/astro.utils';

import { Section } from '@components/ui.components';
import Title from '@components/title.component.astro';
import Info from '@components/info.component.astro'

const { slug: currentSlug } = Astro.params;
const { pathname } = Astro.url;

const basePath = pathname.replace(new RegExp(`/${currentSlug}$`), '');
const collection = await getCollection('verein');
const sections = collection.filter(({ id }) => isInlineSection(id));
---

<DefaultLayout lang="de" title="Kulturverein Lochmühle">
  {
    sections.map(async ({ data, slug, render }) => {
      const { Content } = await render();
      return (
        <Section
          id={`${basePath}/${slug}`}
          style={`
            --kvlm-section-background-from: ${data.backgroundFrom};
            --kvlm-section-background-to: ${data.backgroundTo};
            --kvlm-section-color: ${data.color};
          ` as any}
        >
          <Content components={{ h1: Title, p: Info }} />
        </Section>
      );
    })
  }
</DefaultLayout>
