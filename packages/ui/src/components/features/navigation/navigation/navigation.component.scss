@use 'sass:math';
@use '@/styles/utils';

$background: linear-gradient(
    150deg,
    var(---kvlm-navigation-background-from) 0%,
    var(---kvlm-navigation-background-to) 100%
  )
  no-repeat top / 100vw 100vh;

// prettier-ignore
:host {
  ---kvlm-navigation-background-from: var(--kvlm-navigation-background-from, var(--kvlm-color-turquoise, red));
  ---kvlm-navigation-background-to: var(--kvlm-navigation-background-to, var(--kvlm-color-spray, blue));
  ---kvlm-navigation-color-typo: var(--kvlm-navigation-color-typo, var(--kvlm-color-grey-dark, #000));
  ---kvlm-navigation-height: var(--kvlm-navigation-height, var(--kvlm-header-offset, 100px));
  ---kvlm-navigation-scroll-distance: var(--kvlm-navigation-scroll-distance, 0);
  ---kvlm-navigation-stroke-color: var(--kvlm-navigation-stroke-color, currentColor);
  ---kvlm-navigation-stroke-width: var(--kvlm-navigation-stroke-width, 0.4rem);

  ---kvlm-navigation-shadow-spread: calc(5rem * var(---kvlm-navigation-scroll-distance));
  ---kvlm-navigation-shadow-opacity: calc(0.3 * var(---kvlm-navigation-scroll-distance));
}

:host {
  position: fixed;
  inset: 0 0 auto;
  z-index: 3;

  display: flex;
  flex-direction: row;

  box-shadow: 0 0 var(---kvlm-navigation-shadow-spread)
    rgba(0, 0, 0, var(---kvlm-navigation-shadow-opacity));
  color: var(---kvlm-navigation-color-typo);

  background: $background;
  transition: 0.3s ease;
  transition-property: color;

  @include utils.media-lt(utils.$breakpoint-navigation) {
    background: $background;
    height: 12.6rem;
    overflow: hidden;
    transition: height 0.3s ease;
  }

  @include utils.media-gt(utils.$breakpoint-navigation) {
    align-items: center;
    height: var(---kvlm-navigation-height);
  }
}

@include utils.media-lt(utils.$breakpoint-navigation) {
  :host([opened]) {
    height: 100vh;
  }
}

nav {
  display: flex;

  @include utils.media-lt(utils.$breakpoint-navigation) {
    flex-direction: column;
    gap: 3rem;
    padding: 4rem;
    width: 100vw;
  }

  @include utils.media-gt(utils.$breakpoint-navigation) {
    @include utils.wrapper($padding: 0 5rem);
    align-items: center;
    flex-direction: row;
    gap: 5rem;
  }
}

a:first-child {
  color: inherit;

  @include utils.media-lt(utils.$breakpoint-navigation) {
    display: flex;
    flex-direction: row;
    align-items: center;
    margin-bottom: 5rem;
  }

  @include utils.media-gt(utils.$breakpoint-navigation) {
    margin-right: auto;
  }

  kvlm-logo {
    display: block;
    height: 4.6rem;
    // offset the logo to align with the typo with the content
    // the first letter is set to 7.8 in a container with 246.2 width
    transform: translateX(#{math.div(7.8, 246.2) * 10 - 1%});

    color: inherit;
    transition: color 0.3s ease;

    @include utils.media-lt(utils.$breakpoint-navigation) {
      margin-right: auto;
    }
  }

  svg {
    fill: none;
    stroke: var(---kvlm-navigation-stroke-color);
    stroke-width: var(---kvlm-navigation-stroke-width);

    transition: height 0.3s ease;
    overflow: visible;

    @include utils.media-gt(utils.$breakpoint-navigation) {
      display: none;
    }

    path:nth-child(1n + 2) {
      stroke-dasharray: 25;
      transition: stroke-dashoffset 0.3s ease;
    }

    :host(:not([opened])) & {
      height: 1.64rem;
      stroke-dashoffset: 25;
    }

    :host([opened]) & {
      height: 3.4rem;
      stroke-dashoffset: 0;
    }

    path {
      transition: d 0.3s ease;
      vector-effect: non-scaling-stroke;
    }
  }
}
